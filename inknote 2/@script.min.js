var __extends,FrontEnd,Modal,Actions,Inknote;(function(n){function i(n,t){for(var i=0;i<n.length;i++)if(!t(n[i]))return!1;return!0}function r(n,t){for(var i=0;i<n.length;i++)if(t(n[i]))return!0;return!1}function u(n,t){for(var r=0,i=0;i<n.length;i++)t(n[i])&&r++;return r}function f(n,t){for(var r=[],i=0;i<n.length;i++)t(n[i])&&r.push(n[i]);return r}function e(n,t){for(var r=0,i=0;i<n.length;i++)r+=t(n[i]);return r}function o(n){return n[n.length-1]}function t(n,i){if(!n||!i||n.length!=i.length)return!1;for(var r=0,u=this.length;r<u;r++)if(n[r]instanceof Array&&i[r]instanceof Array){if(!t(n[r],i[r]))return!1}else if(n[r]!=i[r])return!1;return!0}function s(n){for(var i=[],t=0;t<n.length;t++)i.push(n[t]);return i}n.allItemsAre=i;n.anyItemIs=r;n.countWhere=u;n.getItemsWhere=f;n.sum=e;n.last=o;n.arraysAreEqual=t;n.copySimpleArrayFrom=s})(Inknote||(Inknote={})),function(n){function t(){return(new Date).getTime()+""+Math.floor(1e4*Math.random())}function i(n){for(var r="",i=n.split(""),t=0;t<i.length;t++)r+=t==0?i[t].toUpperCase():i[t].toLowerCase();return r}n.getID=t;n.pascalCase=i}(Inknote||(Inknote={})),function(n){function t(n,t,i,r,u,f){var o=t.length,s,e;for(n.beginPath(),n.textAlign="center",n.save(),n.translate(i,r),n.rotate(f/-2),n.rotate(f/o/-2),e=0;e<o;e++)n.rotate(f/o),n.save(),n.translate(0,-1*u),s=t[e],n.font="12px Arial",n.shadowColor="black",n.shadowOffsetX=1,n.shadowOffsetY=1,n.shadowBlur=1,n.fillText(s,0,0),n.restore();n.restore()}n.drawTextAlongArc=t}(Inknote||(Inknote={})),function(n){var t;(function(t){function i(n,t,i,r,u){var f=n-i,e=t-r,o=Math.sqrt(f*f+e*e);return o<=u}function r(t){var i=n.copySimpleArrayFrom(t),r=i.pop();return[r].concat(i)}function u(t,i){for(var e,f,u=n.copySimpleArrayFrom(t),o=n.copySimpleArrayFrom(u),h=t.length,s=0;s<h;s++){for(u=r(u),e=0,f=0;f<u.length;f++)e+=Math.abs(u[f]-i[f]);e<Infinity&&(o=n.copySimpleArrayFrom(u))}return o}t.isWithinRadius=i;t.alignSimilarArrayTo=u})(t=n.Maths||(n.Maths={}))}(Inknote||(Inknote={})),function(n){var t=function(){function t(t){this.staveColour="black";this.noteColour="red";this.textColour="green";this.keypressFuncsOn=!0;this.serverURL="https://lit-basin-6551.herokuapp.com";this.ID=n.getID();this.name=t;this.testMode=!1;this.notationType=0;t||(this.name=this.ID)}return t}();n.Setting=t}(Inknote||(Inknote={})),function(n){var t=function(){function n(){}return n}();n.DrawOptions=t}(Inknote||(Inknote={})),function(n){var t;(function(n){var t=function(){function n(n,t){if(this.top=n,this.bottom=t,Math.round(n)!=n||Math.round(t)!=t)throw new Error("Time signatures can only take integers");}return n}();n.TimeSignature=t})(t=n.Model||(n.Model={}))}(Inknote||(Inknote={})),function(n){var t=function(){function t(t){this.attached=[];this.ID=n.getID();this.order=50;t&&(this.draw=t)}return Object.defineProperty(t.prototype,"ID",{get:function(){return this.attachedToID||this._id},set:function(n){this._id=n},enumerable:!0,configurable:!0}),t.prototype.attach=function(n){n.attachedToID=this.ID;this.attached.push(n)},t.prototype.draw=function(n){return n.beginPath(),n.arc(this.x,this.y,5,0,2*Math.PI),n.fill(),!1},t.prototype.isOver=function(t,i){for(var f=n.Maths.isWithinRadius(t,i,this.x,this.y,10),u=!1,r=0;r<this.attached.length;r++)this.attached[r].isOver(t,i)&&(u=!0);return f||u},t}();n.Notation=t}(Inknote||(Inknote={})),function(n){var t;(function(n){function t(n){switch(n){case 0:case 2:case 3:case 5:case 7:case 8:case 10:return!1;case 11:case 1:case 4:case 6:case 9:return!0}}function i(n){return!t(n)}(function(n){n[n.A=0]="A";n[n.Bb=1]="Bb";n[n.B=2]="B";n[n.C=3]="C";n[n.Db=4]="Db";n[n.D=5]="D";n[n.Eb=6]="Eb";n[n.E=7]="E";n[n.F=8]="F";n[n.Gb=9]="Gb";n[n.G=10]="G";n[n.Ab=11]="Ab"})(n.NoteValue||(n.NoteValue={}));var r=n.NoteValue;n.IsBlackKey=t;n.IsWhiteKey=i})(t=n.Model||(n.Model={}))}(Inknote||(Inknote={})),function(n){var t;(function(n){(function(n){n[n.Breve=0]="Breve";n[n.SemiBreve=1]="SemiBreve";n[n.Minim=2]="Minim";n[n.Crotchet=3]="Crotchet";n[n.Quaver=4]="Quaver";n[n.SemiQuaver=5]="SemiQuaver";n[n.DemiSemiQuaver=6]="DemiSemiQuaver";n[n.HemiDemiSemiQuaver=7]="HemiDemiSemiQuaver"})(n.NoteLength||(n.NoteLength={}));var t=n.NoteLength})(t=n.Model||(n.Model={}))}(Inknote||(Inknote={})),function(n){var t;(function(n){var t=function(){function n(){}return n}();n.Rest=t})(t=n.Model||(n.Model={}))}(Inknote||(Inknote={})),function(n){var t;(function(t){(function(n){n[n.Sharp=0]="Sharp";n[n.Flat=1]="Flat";n[n.Natural=2]="Natural";n[n.DoubleSharp=3]="DoubleSharp";n[n.DoubleFlat=4]="DoubleFlat"})(t.AccidentalType||(t.AccidentalType={}));var r=t.AccidentalType,i=function(){function t(t,i,r){this.ID=n.getID();this.value=t;this.octave=i;this.length=r}return t}();t.Note=i})(t=n.Model||(n.Model={}))}(Inknote||(Inknote={})),function(n){var t;(function(n){var t=function(){function n(n){this.notes=n}return n}();n.Chord=t})(t=n.Model||(n.Model={}))}(Inknote||(Inknote={})),function(n){var t;(function(n){var t=function(){function n(){}return n}();n.Bar=t})(t=n.Model||(n.Model={}))}(Inknote||(Inknote={})),function(n){var t;(function(n){var t=function(){function t(t){this.name=t;this.bars=[];this.visible=!0;this.bars.push(new n.Bar)}return t}();n.Instrument=t})(t=n.Model||(n.Model={}))}(Inknote||(Inknote={})),function(n){var t=function(){function t(t){this.pause=!1;this.ID=n.getID();this.name=t;this.hover=!1;this.instruments=[];this.instruments.push(new n.Model.Instrument("Guitar"));t||(this.name="Untitled")}return t}();n.Project=t}(Inknote||(Inknote={})),function(n){var t=function(){function n(){this.isNote=!0}return Object.defineProperty(n,"Instance",{get:function(){return(this._instance===null||this._instance===undefined)&&(this._instance=new n),this._instance},enumerable:!0,configurable:!0}),n}();n.DrawingSettings=t}(Inknote||(Inknote={})),function(n){var t;(function(n){var t=function(){function n(n,t,i){this.value=n;this.octave=t;this.length=i}return n}();n.CompressedNote=t})(t=n.Compressed||(n.Compressed={}))}(Inknote||(Inknote={})),function(n){var t;(function(n){var t=function(){function n(n){this.notes=n}return n}();n.CompressedChord=t})(t=n.Compressed||(n.Compressed={}))}(Inknote||(Inknote={})),function(n){var t;(function(n){var t=function(){function n(){}return n}();n.Bar=t})(t=n.Compressed||(n.Compressed={}))}(Inknote||(Inknote={})),function(n){var t;(function(n){var t=function(){function t(t){this.name=t;this.bars=[];this.bars.push(new n.Bar)}return t}();n.Instrument=t})(t=n.Compressed||(n.Compressed={}))}(Inknote||(Inknote={})),function(n){var t;(function(t){var i=function(){function t(t){this.name=t;this.ID=n.getID();this.instruments=[];t||(this.name=this.ID)}return t}();t.CompressedProject=i})(t=n.Compressed||(n.Compressed={}))}(Inknote||(Inknote={})),function(n){var t;(function(n){var t=function(){function n(n,t,i,r){this.name=n;this.notesInKey=t;this.sharps=i;this.flats=r}return n.prototype.countSharps=function(){return this.sharps.length},n.prototype.countFlats=function(){return this.flats.length},n}();n.Key=t})(t=n.Model||(n.Model={}))}(Inknote||(Inknote={})),function(n){var t;(function(n){var t=function(){function n(n,t){this.name=n;this.intervals=t}return n}();n.KeyType=t})(t=n.Model||(n.Model={}))}(Inknote||(Inknote={})),function(n){var t;(function(t){function u(t){for(var u=n.Maths.alignSimilarArrayTo(t,i.notesInKey),f=[],r=0;r<u.length;r++)u[r]==i.notesInKey[r]+1&&f.push(i.notesInKey[r]);return f}function f(t){for(var u=n.Maths.alignSimilarArrayTo(t,i.notesInKey),f=[],r=0;r<u.length;r++)u[r]==i.notesInKey[r]-1&&f.push(i.notesInKey[r]);return f}function e(i){var l,o,s,a,e,h,c,v;for(i||(i=0),l=[],o=0;o<r.length;o++){s=r[o];for(a in t.NoteValue){for(e=[],h=new t.Note(parseInt(t.NoteValue[a]),4,1),h.value=(h.value+i)%12,c=0;c<s.intervals.length;c++)v=n.getNoteOfDistance(h,s.intervals[c]),e.push(v.value);l.push(new t.Key(a+" "+s.name,e,u(e),f(e)))}}return l}var r=[new t.KeyType("major",[0,2,4,5,7,9,11]),new t.KeyType("melodic minor",[0,2,3,5,7,8,10]),new t.KeyType("harmonic minor",[0,2,3,5,7,8,11])],i=new t.Key("C_MAJOR",[3,5,7,8,10,0,2],[],[]),o=function(){function n(){}return n.Instance=function(){return n._instance||(n._instance=new n),n._instance},n.prototype.getAllKeys=function(n){return e(n)},n}();t.KeyHolder=o})(t=n.Model||(n.Model={}))}(Inknote||(Inknote={})),function(n){var t;(function(n){function t(n,t){for(var i=0;i<t.notesInKey.length;i++)if(n.value==t.notesInKey[i])return!0;return!1}n.NoteIsInKey=t})(t=n.Model||(n.Model={}))}(Inknote||(Inknote={})),function(n){(function(n){n[n.Standard=0]="Standard";n[n.UPPER_lower=1]="UPPER_lower";n[n.DoReMi=2]="DoReMi"})(n.NotationType||(n.NotationType={}));var t=n.NotationType}(Inknote||(Inknote={})),function(n){var t;(function(n){var t=function(){function n(n,t,i,r){this.baseNote=n;this.rootNote=t;this.minor=i;this.annotations=r}return Object.defineProperty(n.prototype,"name",{get:function(){throw new Error("Not implemented");},enumerable:!0,configurable:!0}),n}();n.DoReMiChordNotation=t})(t=n.ChordNotation||(n.ChordNotation={}))}(Inknote||(Inknote={})),function(n){var t;(function(n){function t(n){return["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B",][n]}var i=function(){function n(n,t,i,r){this.baseNote=n;this.rootNote=t;this.minor=i;this.annotations=r}return Object.defineProperty(n.prototype,"name",{get:function(){var n=t(this.rootNote.value);return this.minor&&(n+="m"),n=n+this.annotations,this.baseNote.value!=this.rootNote.value&&(n+="/"+t(this.baseNote.value)),n},enumerable:!0,configurable:!0}),n}();n.StandardChordNotation=i})(t=n.ChordNotation||(n.ChordNotation={}))}(Inknote||(Inknote={})),function(n){var t;(function(n){function t(n){return["C","Cis","D","Dis","E","F","Fis","G","Gis","A","B","H",][n]}var i=function(){function n(n,t,i,r){this.baseNote=n;this.rootNote=t;this.minor=i;this.annotations=r}return Object.defineProperty(n.prototype,"name",{get:function(){var n=t(this.rootNote.value);return this.minor&&(n=n.toLowerCase()),n=n+this.annotations,this.baseNote.value!=this.rootNote.value&&(n+="/"+t(this.baseNote.value)),n},enumerable:!0,configurable:!0}),n}();n.UPPER_lowerChordNotation=i})(t=n.ChordNotation||(n.ChordNotation={}))}(Inknote||(Inknote={})),function(n){var t;(function(t){var i=function(){function i(){this.ID=n.getID();this.order=100;this.text="Free licence"}return i.prototype.isOver=function(n,t,i){var u=n>i.width-120,f=n<i.width-10,e=t>10,o=t<30,r=u&&f&&e&&o;return this.hover=r?!0:!1,r},i.prototype.click=function(){n.Managers.PageManager.Current.page=4},i.prototype.draw=function(n,i){return n.fillStyle=t.Colours.white,n.strokeStyle=t.Colours.black,this.hover&&(n.strokeStyle=t.Colours.orange),n.beginPath(),n.rect(i.width-120,10,110,20),n.lineWidth=1,n.fill(),n.stroke(),n.fillStyle=t.Colours.black,n.font=t.Fonts.standard,n.beginPath(),n.textAlign="center",n.fillText(this.text,i.width-65,25),this.hover&&(n.beginPath(),n.font=t.Fonts.small,n.textAlign="right",n.fillText("Click to upgrade your licence",i.width-10,45)),!0},i}();t.Licence=i})(t=n.Drawing||(n.Drawing={}))}(Inknote||(Inknote={})),function(n){var t;(function(n){n.Fonts={title:"40px Josefin Sans",large:"18px Josefin Sans",standard:"12px Josefin Sans",small:"10px Josefin Sans",watermark:"42px Josefin Sans"}})(t=n.Drawing||(n.Drawing={}))}(Inknote||(Inknote={})),function(n){var t;(function(n){n.Colours={white:"white",orange:"orange",lightOrange:"rgba(255,150,0,0.5)",tan:"rgb(220, 142, 66)",lightTan:"rgb(240, 162, 86)",peach:"rgb(250, 222, 196)",black:"rgb(10,10,10)",watermarkGray:"rgba(120,120,120,0.1)",shadowGray:"rgba(70,70,70,0.3)",lightGray:"lightgray",gray:"darkgray",darkgray:"gray",darkerGray:"rgb(100,100,100)",darkestGray:"rgb(80,80,80)",translucentBlack:"rgba(0,0,0,0.2)",faintBlue:"rgb(245,245,255)",lightBlue:"lightblue",midBlue:"rgb(100,130,240)",negativeRed:"rgb(255, 129, 129)",negativeHoverRed:"rgb(255,150,150)"}})(t=n.Drawing||(n.Drawing={}))}(Inknote||(Inknote={})),function(n){var t;(function(t){var i=function(){function i(){this.ID=n.getID();this.order=-10;this.mouse={x:-100,y:-100};this.t=0;this.spinners=[]}return Object.defineProperty(i,"Instance",{get:function(){return i._instance||(i._instance=new i),i._instance},enumerable:!0,configurable:!0}),i.prototype.isOver=function(n,t){return this.mouse.x=n,this.mouse.y=t,!1},i.prototype.draw=function(n,i){for(var r=0;r<i.width;r+=4)n.beginPath(),n.moveTo(r,0),n.lineTo(r,i.height),n.strokeStyle=t.Colours.faintBlue,n.stroke();return this.t++,n.save(),n.beginPath(),n.translate(i.width/2,i.height/2),n.rotate(-Math.PI/4),n.font=t.Fonts.watermark,n.textAlign="center",n.fillStyle=t.Colours.watermarkGray,n.fillText("with ♥ - inknote",0,0),n.restore(),!0},i}();t.Background=i})(t=n.Drawing||(n.Drawing={}))}(Inknote||(Inknote={})),function(n){var t;(function(t){var i=function(){function i(t,i){this.y=t;this.name=i;this.order=10;this.ID=n.getID()}return i.prototype.isOver=function(){return!1},i.prototype.draw=function(n,i){this.name&&(n.beginPath(),n.fillStyle=t.Colours.black,n.strokeStyle=t.Colours.black,n.font=t.Fonts.small,n.fillText(this.name,40,this.y-5));for(var r=0;r<5;r++)n.beginPath(),n.strokeStyle=t.Colours.black,n.moveTo(30,this.y+10*r),n.lineTo(i.width-30,this.y+10*r),n.stroke();return!0},i}();t.Stave=i})(t=n.Drawing||(n.Drawing={}))}(Inknote||(Inknote={}));__extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},function(n){var t;(function(t){function i(n,t,i,r){n.beginPath();n.moveTo(t-r/5,i+r*4/3);n.lineTo(t-r/5,i-r*6/5);n.moveTo(t+r/5,i+r*6/5);n.lineTo(t+r/5,i-r*4/3);n.stroke();n.beginPath();n.lineWidth=2;n.moveTo(t-r/2,i-r/4);n.lineTo(t+r/2,i-r*3/4);n.moveTo(t-r/2,i+r*3/4);n.lineTo(t+r/2,i+r/4);n.stroke()}var r=function(n){function r(){n.apply(this,arguments)}return __extends(r,n),r.prototype.draw=function(n){return n.strokeStyle=t.Colours.black,n.fillStyle=t.Colours.black,this.hover&&(n.strokeStyle=t.Colours.orange,n.fillStyle=t.Colours.orange),i(n,this.x,this.y,10),n.lineWidth=1,!0},r}(n.Notation);t.Sharp=r})(t=n.Drawing||(n.Drawing={}))}(Inknote||(Inknote={})),function(n){var t;(function(t){function i(n,t,i,r){n.beginPath();n.moveTo(t-r/2,i-r/2);n.bezierCurveTo(t+r/2,i-r/4,t+r/2,i+r/4,t-r/2,i+r/2);n.bezierCurveTo(t,i,t,i,t-r/2,i-r/2);n.fill();n.beginPath();n.moveTo(t-r/2,i+r/2);n.lineTo(t-r/2,i-r*3/2);n.stroke()}var r=function(n){function r(){n.apply(this,arguments)}return __extends(r,n),r.prototype.draw=function(n){return n.strokeStyle=t.Colours.black,n.fillStyle=t.Colours.black,this.hover&&(n.strokeStyle=t.Colours.orange,n.fillStyle=t.Colours.orange),i(n,this.x,this.y,10),!0},r}(n.Notation);t.Flat=r})(t=n.Drawing||(n.Drawing={}))}(Inknote||(Inknote={})),function(n){var t;(function(t){function i(n,t,i,r){n.beginPath();n.moveTo(t-r/4,i+r*3/4);n.lineTo(t-r/4,i-r*3/2);n.moveTo(t+r/4,i+r*3/2);n.lineTo(t+r/4,i-r*3/4);n.stroke();n.beginPath();n.lineWidth=2;n.moveTo(t-r/4,i-r/4);n.lineTo(t+r/4,i-r*3/4);n.moveTo(t-r/4,i+r*3/4);n.lineTo(t+r/4,i+r/4);n.stroke()}var r=function(n){function r(){n.apply(this,arguments)}return __extends(r,n),r.prototype.draw=function(n){return n.strokeStyle=t.Colours.black,n.fillStyle=t.Colours.black,this.hover&&(n.strokeStyle=t.Colours.orange,n.fillStyle=t.Colours.orange),i(n,this.x,this.y,10),n.lineWidth=1,!0},r}(n.Notation);t.Natural=r})(t=n.Drawing||(n.Drawing={}))}(Inknote||(Inknote={})),function(n){var t;(function(t){function r(n,i,r,u,f){if(n.fillStyle=t.Colours.black,n.strokeStyle=t.Colours.black,u.isPotential&&(n.fillStyle=t.Colours.midBlue,n.strokeStyle=t.Colours.midBlue),u.select&&(n.beginPath(),n.arc(i,r,f,0,2*Math.PI),n.strokeStyle=t.Colours.orange,n.fillStyle=t.Colours.orange,n.stroke()),u.hover&&(n.strokeStyle=t.Colours.orange,n.fillStyle=t.Colours.orange),u.noteLength==0){n.lineWidth=2;return}if(n.beginPath(),n.arc(i,r,f/2,0,2*Math.PI,!1),u.noteLength==1)n.lineWidth=2,n.stroke(),n.lineWidth=1;else if(u.noteLength==2?(n.lineWidth=2,n.stroke(),n.lineWidth=1):n.fill(),n.beginPath(),u.stemUp){if(n.moveTo(i+f/2-.5,r),n.lineTo(i+f/2-.5,r-f*7/2),n.stroke(),u.noteLength>3)for(var o=i+f/2-.5,e=r-f*7/2,h=u.noteLength-3,s=0;h>=1;)n.beginPath(),n.moveTo(o,e),n.bezierCurveTo(o+1,e+10,o+15,e+13,o+7,e+25),n.bezierCurveTo(o+13,e+13,o,e+8,o,e+15),n.lineTo(o,e),n.fill(),n.stroke(),h--,s==0?e+=10:e-=s==1?20:10,s++}else if(n.moveTo(i-f/2+.5,r),n.lineTo(i-f/2+.5,r+f*7/2),n.stroke(),u.noteLength>3)for(var o=i+.5-f/2,e=r+f*7/2,h=u.noteLength-3,s=0;h>=1;)n.beginPath(),n.moveTo(o,e),n.bezierCurveTo(o+1,e-10,o+15,e-13,o+7,e-25),n.bezierCurveTo(o+13,e-13,o,e-8,o,e-15),n.lineTo(o,e),n.fill(),n.stroke(),h--,s==0?e-=10:e+=s==1?20:10,s++}var i=function(n){function t(t){n.call(this);this.stemUp=t;this.isPotential=!1}return __extends(t,n),t}(n.Notation),u,f,e,o,s,h,c,l;t.Note=i;u=function(n){function t(){n.apply(this,arguments);this.noteLength=0}return __extends(t,n),t.prototype.draw=function(n){return r(n,this.x,this.y,this,10),!0},t}(i);t.Breve=u;f=function(n){function t(){n.apply(this,arguments);this.noteLength=1}return __extends(t,n),t.prototype.draw=function(n){return r(n,this.x,this.y,this,10),!0},t}(i);t.SemiBreve=f;e=function(n){function t(){n.apply(this,arguments);this.noteLength=2}return __extends(t,n),t.prototype.draw=function(n){return r(n,this.x,this.y,this,10),!0},t}(i);t.Minim=e;o=function(n){function t(){n.apply(this,arguments);this.noteLength=3}return __extends(t,n),t.prototype.draw=function(n){return r(n,this.x,this.y,this,10),!0},t}(i);t.Crotchet=o;s=function(n){function t(){n.apply(this,arguments);this.noteLength=4}return __extends(t,n),t.prototype.draw=function(n){return r(n,this.x,this.y,this,10),!0},t}(i);t.Quaver=s;h=function(n){function t(){n.apply(this,arguments);this.noteLength=5}return __extends(t,n),t.prototype.draw=function(n){return r(n,this.x,this.y,this,10),!0},t}(i);t.SemiQuaver=h;c=function(n){function t(){n.apply(this,arguments);this.noteLength=6}return __extends(t,n),t.prototype.draw=function(n){return r(n,this.x,this.y,this,10),!0},t}(i);t.DemiSemiQuaver=c;l=function(n){function t(){n.apply(this,arguments);this.noteLength=7}return __extends(t,n),t.prototype.draw=function(n){return r(n,this.x,this.y,this,10),!0},t}(i);t.HemiDemiSemiQuaver=l})(t=n.Drawing||(n.Drawing={}))}(Inknote||(Inknote={})),function(n){var t;(function(t){function u(n,i){n.strokeStyle=t.Colours.black;n.fillStyle=t.Colours.black;i.hover&&(n.strokeStyle=t.Colours.orange,n.fillStyle=t.Colours.orange)}function f(n,t,i,r){n.beginPath();n.moveTo(t,i);n.lineTo(t+2*r,i);n.lineTo(t+2*r,i+r/2);n.lineTo(t,i+r/2);n.lineTo(t,i);n.fill()}function e(n,t,i,r){n.beginPath();n.moveTo(t,i);n.lineTo(t+2*r,i);n.lineTo(t+2*r,i-r/2);n.lineTo(t,i-r/2);n.lineTo(t,i);n.fill()}function o(n,t,i,r){n.beginPath();n.moveTo(t,i);n.quadraticCurveTo(t+r,i-r/2,t,i-r);n.quadraticCurveTo(t+2*r,i,t+r/2,i+r/2);n.quadraticCurveTo(t-r,i+r,t+r/2,i+3*r/2);n.quadraticCurveTo(t-r/2,i+7*r/4,t,i+5*r/2);n.quadraticCurveTo(t-3*r/2,i+6*r/4,t+r/2,i+3*r/2);n.quadraticCurveTo(t-2*r,i+r/2,t,i);n.fill();n.stroke()}function i(n,t,i,r){n.beginPath();n.arc(t,i,r/4,0,2*Math.PI);n.fill();n.moveTo(t,i);n.bezierCurveTo(t+r/2,i+r,t+3*r/2,i+r/2,t+2*r,i);n.bezierCurveTo(t+3*r/2,i+r/2,t+r/2,i+r,t-r/5,i+r*.75/4);n.stroke();n.fill();n.moveTo(t+2*r,i);n.lineTo(t,i+r*4);n.stroke()}function s(n,t,r,u){i(n,t,r,u);i(n,t-u,r+2*u,u)}function h(n,t,r,u){i(n,t,r,u);i(n,t-u,r+2*u,u);i(n,t+u,r-2*u,u)}function c(n,t,r,u){i(n,t,r,u);i(n,t-u,r+2*u,u);i(n,t+u,r-2*u,u);i(n,t-u*2,r+4*u,u)}var r=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t}(n.Notation),l,a,v,y,p,w,b,k;t.Rest=r;l=function(n){function i(){n.apply(this,arguments)}return __extends(i,n),i.prototype.draw=function(n){u(n,this);n.beginPath();n.strokeStyle=t.Colours.black;n.fillStyle=t.Colours.black;n.rect(this.x-5,this.y-5,this.x+5,this.y+5);n.stroke();throw new Error("Incorrect breve rest drawing implementation");},i}(r);t.BreveRest=l;a=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.prototype.draw=function(n){return u(n,this),f(n,this.x,this.y,5),!0},t}(r);t.SemiBreveRest=a;v=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.prototype.draw=function(n){return u(n,this),e(n,this.x,this.y,5),!0},t}(r);t.MinimRest=v;y=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.prototype.draw=function(n){return u(n,this),o(n,this.x,this.y,5),!0},t}(r);t.CrotchetRest=y;p=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.prototype.draw=function(n){return u(n,this),i(n,this.x,this.y,5),!0},t}(r);t.QuaverRest=p;w=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.prototype.draw=function(n){return u(n,this),s(n,this.x,this.y,5),!0},t}(r);t.SemiQuaverRest=w;b=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.prototype.draw=function(n){return u(n,this),h(n,this.x,this.y,5),!0},t}(r);t.DemiSemiQuaverRest=b;k=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.prototype.draw=function(n){return u(n,this),c(n,this.x,this.y,5),!0},t}(r);t.HemiDemiSemiQuaverRest=k})(t=n.Drawing||(n.Drawing={}))}(Inknote||(Inknote={})),function(n){var t;(function(t){var i=function(){function i(){this.ID=n.getID();this.t=0;this.x=0;this.y=0;this.order=100;this.hover=!1;this.select=!1;this.x=5;this.y=7;var i=this;i.draw=function(r,u){return this.t++,r.beginPath(),r.fillStyle=t.Colours.translucentBlack,r.rect(0,0,u.width,u.height),r.fill(),r.beginPath(),r.fillStyle="orange",r.arc(u.width/2,u.height/2,80,0,2*Math.PI),r.fill(),n.drawTextAlongArc(r,"Loading",u.width/2,u.height/2,90,1),r.beginPath(),r.fillStyle="black",r.arc(50*Math.sin(i.t/100)*Math.sin(i.t/50)+u.width/2,50*Math.sin(i.t/100)*Math.cos(i.t/50)+u.height/2,10*Math.abs(Math.sin(i.t/100)),0,2*Math.PI),r.arc(-50*Math.sin(i.t/100)*Math.sin(i.t/50)+u.width/2,-50*Math.sin(i.t/100)*Math.cos(-i.t/50)+u.height/2,10*Math.abs(Math.sin(i.t/100)),0,2*Math.PI),r.fill(),!0}}return i.prototype.isOver=function(t,i){return n.Maths.isWithinRadius(t,i,this.x,this.y,10)},i}();t.LoadingSplash=i})(t=n.Drawing||(n.Drawing={}))}(Inknote||(Inknote={})),function(n){var t;(function(t){var i=function(){function i(i){this.ID=n.getID();this.x=0;this.y=0;this.order=100;this.hover=!1;this.select=!1;this.name=i;this.x=0;this.y=0;var r=this;r.draw=function(i,u){if(r.select){i.beginPath();i.fillStyle=t.Colours.white;var f=n.Managers.ProjectManager.Instance.currentProject.name.length*30+100;i.rect(u.width/2-f/2,60,f,50);i.strokeStyle=t.Colours.lightOrange;i.lineWidth=10;i.stroke();this.name.length>0?(i.beginPath(),i.fillStyle=t.Colours.black,i.textAlign="center",i.fillText("Click delete to clear text",u.width/2,50),i.fill()):(i.beginPath(),i.fillStyle=t.Colours.black,i.textAlign="center",i.fillText("Please type a project name",u.width/2,50),i.fill())}return i.beginPath(),i.fillStyle=t.Colours.orange,i.font=t.Fonts.title,i.textAlign="center",i.fillText(r.name,u.width/2,100),i.fill(),r.hover&&(i.beginPath(),i.rect(u.width/2-50,105,100,10),i.fill(),r.select||(i.beginPath(),i.font=t.Fonts.small,i.fillStyle=t.Colours.black,i.textAlign="center",i.fillText("Click to edit project name",u.width/2,50),i.fill())),!0}}return i.prototype.isOver=function(n,t,i){return t<100&&t>65&&n>i.width/2-150&&n<i.width/2+150},i}();t.Name=i})(t=n.Drawing||(n.Drawing={}))}(Inknote||(Inknote={})),function(n){var t;(function(t){var i=function(){function i(i){this.name=i;this.ID=n.getID();this.order=10;this.hover=!1;this.select=!1;var r=this;r.draw=function(n){(r.hover||r.select)&&(n.fillStyle=t.Colours.lightBlue,n.beginPath(),n.rect(r.x-60,r.y-60,120,140),n.fill());var u=n.createLinearGradient(r.x-50,r.y-50,r.x+50,r.y+50),i=20;return r.select?(u.addColorStop(0,t.Colours.lightTan),i=0):u.addColorStop(0,t.Colours.tan),u.addColorStop(1,t.Colours.peach),n.fillStyle=u,n.beginPath(),n.moveTo(r.x-50,r.y+50),n.lineTo(r.x+50,r.y+50),n.lineTo(r.x+50,r.y-50),n.lineTo(r.x-i,r.y-50),n.lineTo(r.x-50,r.y-i),n.fill(),n.beginPath(),n.moveTo(r.x-(i+4),r.y-45),n.lineTo(r.x-45,r.y-45),n.lineTo(r.x-45,r.y-(i+4)),n.strokeStyle=t.Colours.black,n.fillStyle=t.Colours.white,n.fill(),n.stroke(),n.beginPath(),n.fillStyle=t.Colours.black,n.textAlign="center",n.fillText(r.name,r.x,r.y+70),r.hover&&(n.strokeStyle=t.Colours.midBlue,n.beginPath(),n.rect(r.x-60,r.y-60,120,140),n.stroke()),!0}}return i.prototype.isOver=function(n,t){return n<this.x+50&&n>this.x-50?t<this.y+80&&t>this.y-50:!1},i}();t.File=i})(t=n.Drawing||(n.Drawing={}))}(Inknote||(Inknote={})),function(n){var t;(function(n){function i(n,i,r,u,f){for(var e=n.split(""),h=[],o=u/e.length,c=0,s=0;s<e.length;s++)h.push(new t(e[s],i+o*c+o/2,r+f/2,o-2,f-2)),c++;return h}function r(n,i,r,u,f){for(var e=n,h=[],o=u/e.length,c=0,s=0;s<e.length;s++)h.push(new t(e[s],i+o*c+o/2,r+f/2,o-2,f-4)),c++;return h}var t=function(){function t(n,t,i,r,u){this.name=n;this.x=t;this.y=i;this.width=r;this.height=u}return t.prototype.draw=function(t){if(this.name!=""){t.beginPath();t.rect(this.x-this.width/2,this.y-this.height/2,this.width,this.height);var i=t.createLinearGradient(this.x-this.width/2,this.y-this.height/2,this.x+this.width/2,this.y+this.height/2);this.hover?i.addColorStop(0,n.Colours.lightBlue):i.addColorStop(0,n.Colours.darkestGray);i.addColorStop(1,n.Colours.black);t.fillStyle=i;t.fill();t.beginPath();t.fillStyle=n.Colours.white;t.textAlign="center";t.font=n.Fonts.large;t.fillText(this.name,this.x,this.y+5)}},t.prototype.isOver=function(n,t){if(this.name=="")return!1;var i=n>this.x-this.width/2,r=n<this.x+this.width/2,u=t>this.y-this.height/2,f=t<this.y+this.height/2;return i&&r&&u&&f},t}();n.KeyboardKey=t;n.keysFromString=i;n.keysFromArray=r})(t=n.Drawing||(n.Drawing={}))}(Inknote||(Inknote={})),function(n){var t;(function(t){var i=function(){function i(){this.ID=n.getID();this.order=200;this.cSize={x:0,y:0};var i=this;i.draw=function(n,r){var u,f;for((r.width!=i.cSize.x||r.height!=i.cSize.y)&&(i.cSize={x:r.width,y:r.height},i.keys=[],i.keys=i.keys.concat(t.keysFromString("qwertyuiop",0,r.height/2+0*r.height,r.width,r.height/8)),i.keys=i.keys.concat(t.keysFromString("asdfghjkl-",0,r.height/2+r.height/8,r.width,r.height/8)),i.keys=i.keys.concat(t.keysFromString("zxcvbnm,./",0,r.height/2+r.height/4,r.width,r.height/8)),i.keys=i.keys.concat(t.keysFromArray(["|<"," "," "," ","Delete"],0,r.height/2+3*r.height/8,r.width,r.height/8))),n.font=t.Fonts.standard,n.lineWidth=1,n.strokeStyle=t.Colours.black,n.beginPath(),u=n.createLinearGradient(0,r.height/2,r.width/2,r.height),u.addColorStop(0,t.Colours.darkestGray),u.addColorStop(1,t.Colours.darkerGray),n.fillStyle=u,n.rect(0,r.height/2,r.width,r.height/2),n.fill(),f=0;f<i.keys.length;f++)i.keys[f].draw(n,r);return!0}}return Object.defineProperty(i,"Instance",{get:function(){return i._instance||(i._instance=new i),i._instance},enumerable:!0,configurable:!0}),i.prototype.isOver=function(n,t){for(var r=!1,i=0;i<this.keys.length;i++)this.keys[i].isOver(n,t)?(this.keys[i].hover=!0,r=!0):this.keys[i].hover=!1;return r},i.prototype.click=function(t){for(var u=n.Managers.ProjectManager.Instance,i=u.currentProject,r=0;r<this.keys.length;r++)this.keys[r].isOver(t.clientX,t.clientY-50)&&(this.keys[r].name=="Delete"?u.selectID==i.ID&&(i.name=""):this.keys[r].name=="|<"?u.selectID==i.ID&&(i.name=i.name.substr(0,i.name.length-1)):(console.log(this.keys[r].name),i.name=n.pascalCase(i.name+this.keys[r].name)))},i}();t.Keyboard=i})(t=n.Drawing||(n.Drawing={}))}(Inknote||(Inknote={})),function(n){var t;(function(t){function r(t,r,u,f,e){for(var h,s=[],l=[],o=0;o<t.length;o++){if(h=t[o],!h.click||!h.text){n.log("bad item in menu array");continue}s.push(h)}var v=s.length,c=f/v,a=0;for(o=0;o<s.length;o++)l.push(new i(s[o].text,a*c+c/20,u+e/10,c-c/10,8*e/10,s[o].click,s[o].negative)),a++;return l}var i=function(){function n(n,t,i,r,u,f,e){this.negative=e;this.text=n;this.x=t;this.y=i;this.width=r;this.height=u;this.click=f}return n.prototype.isOver=function(n,t){var i=n>=this.x,r=n<=this.x+this.width,u=t<=this.y+this.height,f=t>=this.y;return i&&r&&u&&f},n.prototype.draw=function(n){n.beginPath();var i=n.createLinearGradient(this.x,this.y,this.x+this.width,this.y+this.height);this.hover?i.addColorStop(0,t.Colours.lightBlue):i.addColorStop(0,t.Colours.gray);i.addColorStop(1,t.Colours.white);n.fillStyle=i;this.negative&&(n.fillStyle=t.Colours.negativeRed,this.hover&&(n.fillStyle=t.Colours.negativeHoverRed));n.rect(this.x,this.y,this.width,this.height);n.fill();this.hover&&(n.strokeStyle=t.Colours.white,n.stroke());n.beginPath();n.fillStyle=t.Colours.black;n.textAlign="center";n.fillText(this.text,this.x+this.width/2,this.y+this.height/2+5);n.fill()},n}();t.BottomMenuButton=i;t.createMenuFromArray=r})(t=n.Drawing||(n.Drawing={}))}(Inknote||(Inknote={})),function(n){var t;(function(t){var i=function(){function i(){this.ID=n.getID();this.order=150;this.buttons=[];var i=this;i.draw=function(r,u){i.buttons.length<1?i.buttons=t.createMenuFromArray([{text:"Open",click:function(){n.Managers.ProjectManager.Instance.openSelectedProject()}},{text:"<",click:function(){n.Managers.ProjectManager.Instance.previous()}},{text:">",click:function(){n.Managers.ProjectManager.Instance.next()}},{text:"Delete",click:function(){var t=n.Managers.ProjectManager.Instance;t.deleteSelectedProject()},negative:!0}],0,u.height-100,u.width,100):this.resizeButtons(u);r.beginPath();r.fillStyle="black";r.rect(0,u.height-100,u.width,100);r.fill();for(var f=0;f<i.buttons.length;f++)i.buttons[f].draw(r);return!0}}return Object.defineProperty(i,"Instance",{get:function(){return i._instance||(i._instance=new i),i._instance},enumerable:!0,configurable:!0}),i.prototype.isOver=function(n,t,i){for(var r=0;r<this.buttons.length;r++)this.buttons[r].hover=this.buttons[r].isOver(n,t)?!0:!1;return t>i.height-100},i.prototype.click=function(t){for(var r=n.Managers.ProjectManager.Instance,u=r.currentProject,i=0;i<this.buttons.length;i++)this.buttons[i].isOver(t.clientX,t.clientY-50)&&(this.buttons[i].click(),t.preventDefault())},i.prototype.resizeButtons=function(n){for(var t=this.buttons,e=t.length,r=n.width/e,u=0,f=100,i=0;i<t.length;i++)t[i].x=u*r+r/20,t[i].y=n.height-100+f/10,t[i].width=r-r/10,t[i].height=8*f/10,u++},i}();t.BottomMenu=i})(t=n.Drawing||(n.Drawing={}))}(Inknote||(Inknote={})),function(n){var t;(function(t){var i=function(){function t(){this.ID=n.getID();this.order=150;var t=this;t.draw=function(){return!0}}return Object.defineProperty(t,"Instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),t}();t.ScoreMenu=i})(t=n.Drawing||(n.Drawing={}))}(Inknote||(Inknote={})),function(n){var t;(function(t){var i=function(i){function r(){i.apply(this,arguments)}return __extends(r,i),r.prototype.draw=function(i){var r=this.standardChord,u=n.getCurrentChordNotation(r.baseNote,r.rootNote,r.minor,r.annotations),f=u.name;return i.beginPath(),i.fillStyle=t.Colours.black,i.strokeStyle=t.Colours.black,i.textAlign="center",i.fillText(f,this.x,this.y),!0},r}(n.Notation);t.ChordSymbol=i})(t=n.Drawing||(n.Drawing={}))}(Inknote||(Inknote={})),function(n){var t;(function(t){var i;(function(i){var r=function(){function r(){this.ID=n.getID();this.y=50;this.width=25;this.order=200;this.buttonHeight=20;this.scrollThumbnail=new i.ScrollThumbnail}return r.prototype.click=function(t){t.clientY<50+this.y+this.buttonHeight?n.ScrollService.Instance.up():t.clientY>50+this.y+this.height-this.buttonHeight&&n.ScrollService.Instance.down()},r.prototype.isOver=function(n,t){var r=n>this.x,u=n<this.x+this.width,f=t>this.y,e=t<this.y+this.height,i=r&&u&&f&&e;return this.isOverTopButton=!1,this.isOverBottomButton=!1,this.isOverMiddle=!1,i&&(t<this.y+this.buttonHeight?(this.scrollThumbnail.visible=!1,this.isOverTopButton=!0):t>this.y+this.height-this.buttonHeight?(this.isOverBottomButton=!0,this.scrollThumbnail.visible=!1):(this.isOverMiddle=!0,this.scrollThumbnail.visible=!0,this.scrollThumbnail.y=t,this.scrollThumbnail.x=this.x-3-this.scrollThumbnail.width)),this.hover=i,i},r.prototype.draw=function(n,i){return this.x=i.width-this.width,this.height=i.height-this.y,n.beginPath(),n.clearRect(this.x,this.y,this.width,this.height),n.fillStyle=t.Colours.lightBlue,this.isOverMiddle&&(n.beginPath(),n.rect(this.x,this.y+this.buttonHeight,this.width,this.height-2*this.buttonHeight),n.fill()),n.beginPath(),n.strokeStyle=t.Colours.black,n.moveTo(this.x,this.y+this.buttonHeight),n.lineTo(this.x,i.height-this.buttonHeight),n.stroke(),n.beginPath(),n.rect(this.x,this.y,this.width,this.buttonHeight),n.moveTo(this.x+this.width/2,this.y+this.buttonHeight*2/3),n.lineTo(this.x+this.width/2,this.y+this.buttonHeight/3),n.moveTo(this.x+this.width/2+3,this.y+this.buttonHeight/2),n.lineTo(this.x+this.width/2,this.y+this.buttonHeight/3),n.moveTo(this.x+this.width/2-3,this.y+this.buttonHeight/2),n.lineTo(this.x+this.width/2,this.y+this.buttonHeight/3),this.isOverTopButton&&n.fill(),n.stroke(),n.beginPath(),n.rect(this.x,i.height-this.buttonHeight,this.width,this.buttonHeight),n.moveTo(this.x+this.width/2,i.height-this.buttonHeight*2/3),n.lineTo(this.x+this.width/2,i.height-this.buttonHeight/3),n.moveTo(this.x+this.width/2+3,i.height-this.buttonHeight/2),n.lineTo(this.x+this.width/2,i.height-this.buttonHeight/3),n.moveTo(this.x+this.width/2-3,i.height-this.buttonHeight/2),n.lineTo(this.x+this.width/2,i.height-this.buttonHeight/3),this.isOverBottomButton&&n.fill(),n.stroke(),!0},r}();i.ScrollBar=r})(i=t.ScrollBar||(t.ScrollBar={}))})(t=n.Drawing||(n.Drawing={}))}(Inknote||(Inknote={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t}(n.ScrollBar);n.FileScroll=t})(t=n.ScrollBar||(n.ScrollBar={}))})(t=n.Drawing||(n.Drawing={}))}(Inknote||(Inknote={})),function(n){var t;(function(t){var i;(function(i){var r=function(){function i(){this.ID=n.getID();this.width=80;this.height=100;this.invert=!1;this.visible=!1;this.order=201}return i.prototype.click=function(){alert("Scroll thumb")},i.prototype.isOver=function(n,t){var i=n>this.x,r=n<this.x+this.width,u=t>this.y,f=t<this.y+this.height;return i&&r&&u&&f},i.prototype.draw=function(n,i){this.invert=this.y+this.height>i.height?!0:!1;var r=this.invert?this.y-this.height:this.y,f=this.height,u=this.x;return n.strokeStyle=t.Colours.black,n.fillStyle=t.Colours.white,n.lineWidth=2,this.invert?(n.beginPath(),n.moveTo(u,r),n.lineTo(u,r+this.height),n.lineTo(u+this.width+10,r+this.height),n.lineTo(u+this.width,r+this.height-5),n.lineTo(u+this.width,r),n.lineTo(u,r),n.fill(),n.stroke()):(n.beginPath(),n.moveTo(u,r),n.lineTo(u+this.width+10,r),n.lineTo(u+this.width,r+5),n.lineTo(u+this.width,r+f),n.lineTo(u,r+f),n.lineTo(u,r),n.fill(),n.stroke()),n.lineWidth=1,!0},i}();i.ScrollThumbnail=r})(i=t.ScrollBar||(t.ScrollBar={}))})(t=n.Drawing||(n.Drawing={}))}(Inknote||(Inknote={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(){n.apply(this,arguments);this.width=25}return __extends(t,n),t}(n.ScrollBar);n.ProjectDcroll=t})(t=n.ScrollBar||(n.ScrollBar={}))})(t=n.Drawing||(n.Drawing={}))}(Inknote||(Inknote={})),function(n){var t;(function(t){var i;(function(i){var r=function(){function n(n,t){this.text=n;this.click=t}return n}(),u;i.ClickableMenuItem=r;u=function(){function i(){this.items=[new r("save",function(){n.Action(2)}),new r("plugins",function(){Modal.toggle("plugins")}),new r("report bug",function(){Modal.toggle("report")})];this.ID=n.getID();this.width=100;this.order=500}return Object.defineProperty(i.prototype,"itemHeight",{get:function(){return 25},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"height",{get:function(){return this.items.length*this.itemHeight},enumerable:!0,configurable:!0}),i.prototype.draw=function(n){var i,r,u;for(n.beginPath(),n.fillStyle=t.Colours.shadowGray,n.rect(this.x+4,this.y+3,this.width,this.height),n.fill(),n.beginPath(),n.fillStyle=t.Colours.white,n.strokeStyle=t.Colours.black,n.rect(this.x,this.y,this.width,this.height),n.fill(),n.stroke(),i=0;i<this.items.length;i++)this.items[i].hover&&(n.beginPath(),n.fillStyle=t.Colours.orange,n.rect(this.x,i*25+this.y,this.width,this.itemHeight),n.fill()),n.beginPath(),r=(i+1)*25+this.y,u=r-8,n.font=t.Fonts.standard,n.textAlign="center",n.fillStyle=t.Colours.black,n.fillText(this.items[i].text,this.x+this.width/2,u),i<this.items.length-1&&(n.beginPath(),n.strokeStyle=t.Colours.gray,n.moveTo(this.x,r),n.lineTo(this.x+this.width,r),n.stroke());return!0},i.prototype.isOver=function(n,t){for(var u=n>this.x,f=n<this.x+this.width,e=t>this.y,o=t<this.y+this.height,r=u&&f&&e&&o,s=Math.floor((t-this.y)/this.itemHeight),i=0;i<this.items.length;i++)this.items[i].hover=r&&i==s?!0:!1;return r},i.prototype.click=function(n){var r=n.clientX,t=n.clientY-50,i=Math.floor((t-this.y)/this.itemHeight);this.items[i].click()},i}();i.RightClickMenu=u})(i=t.RightClickMenus||(t.RightClickMenus={}))})(t=n.Drawing||(n.Drawing={}))}(Inknote||(Inknote={})),function(n){var t;(function(t){var i;(function(t){var i=function(i){function r(r){i.call(this);this.items=[new t.ClickableMenuItem("open",function(){n.Managers.ProjectManager.Instance.openProjectFromID(n.RightClickMenuService.Instance.Menu.fileID)}),new t.ClickableMenuItem("open in new tab",function(){n.Managers.PageManager.Current.openNewPage(0,n.RightClickMenuService.Instance.Menu.fileID)}),new t.ClickableMenuItem("delete",function(){n.Managers.ProjectManager.Instance.deleteProjectByID(n.RightClickMenuService.Instance.Menu.fileID)})];this.fileID=r}return __extends(r,i),r}(t.RightClickMenu);t.RightClickFile=i})(i=t.RightClickMenus||(t.RightClickMenus={}))})(t=n.Drawing||(n.Drawing={}))}(Inknote||(Inknote={})),function(n){var t;(function(t){function r(t){return localStorage?JSON.parse(localStorage.getItem("inknote-"+t)):(n.log("Local storage is undefined",0),null)}function u(t,i){if(!n.Managers.SettingsManager.Current.testMode){if(!localStorage)return n.log("Local storage is undefined",0),null;localStorage.setItem("inknote-"+t,JSON.stringify(i))}}function f(){if(n.Managers.SettingsManager.Current.testMode)return[];var t=r(i.settings);return t instanceof Array==!0&&n.allItemsAre(t,function(t){return t instanceof n.Setting})?t:(n.log("localStorage settings are not saved in the correct format",2),[])}function e(){if(n.Managers.SettingsManager.Current.testMode)return[n.Testing.$TEST$_compressedProject];var t=r(i.projects);return t instanceof Array==!0&&n.allItemsAre(t,function(n){return!!n.ID&&!!n.name})?t:(n.log("localStorage projects are not saved in the correct format"),[])}function o(t){var f,r;if(u(i.projects,t),n.Managers.PluginManager)for(f=n.getItemsWhere(n.Managers.PluginManager.Instance.plugins,function(n){return n.active&&n.allowOnSave&&n.onSave!=null}),r=0;r<f.length;r++)f[r].onSave()}function s(){u(i.plugins,n.Managers.PluginManager.Instance.getCompressedPlugins());n.log("saved plugins")}function h(){var n=r(i.plugins);return n==null||n==undefined?[]:n}var i={settings:"settings",projects:"projects",plugins:"plugins"};t.getSettings=f;t.getProjects=e;t.saveProjects=o;t.savePlugins=s;t.getPlugins=h})(t=n.Storage||(n.Storage={}))}(Inknote||(Inknote={})),function(n){function t(t,i,r){var e,o,l,u,s,f,h,c;n.CONFIRM_IS_OPEN=!0;e=document.getElementById("confirm-cover");FrontEnd.showElement(e);o=document.getElementById("confirm-box");FrontEnd.showElement(o);l=document.getElementById("confirm-text");l.innerText=t;u=document.getElementById("confirm-ok");s=function(){FrontEnd.hideElement(o);FrontEnd.hideElement(e);i();setTimeout(function(){n.CONFIRM_IS_OPEN=!1},300)};u.onclick=s;u.onmouseup=function(){u.removeEventListener("click",s)};u.focus();f=document.getElementById("confirm-cancel");h=function(n){n.preventDefault();u.focus()};f.onblur=h;c=function(){FrontEnd.hideElement(o);FrontEnd.hideElement(e);r();setTimeout(function(){n.CONFIRM_IS_OPEN=!1},300)};f.onclick=c;f.onmouseup=function(){f.removeEventListener("click",c);f.removeEventListener("blur",h)}}n.CONFIRM_IS_OPEN=!1;n.check=t}(Inknote||(Inknote={})),function(n){function t(n,t){t==0?console.log("%c"+n,"color:red"):t==2?console.log("%c"+n,"color: orange"):console.log(n)}(function(n){n[n.Error=0]="Error";n[n.Text=1]="Text";n[n.Warning=2]="Warning"})(n.MessageType||(n.MessageType={}));var i=n.MessageType;n.log=t}(Inknote||(Inknote={})),function(n){function t(n,t){for(var i=0;i<n.length;i++)if(n[i].ID==t)return i;return null}function i(n,t){for(var i=0;i<n.length;i++)if(n[i].ID==t)return n[i];return null}n.getIndexFromID=t;n.getItemFromID=i}(Inknote||(Inknote={})),function(n){var t=function(){function t(){this.x=0;this.y=0;this.scrollSpeed=30}return Object.defineProperty(t,"Instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ScrollBar",{get:function(){if(n.Managers.PageManager.Current.page!=t._lastPageType){t._lastPageType=n.Managers.PageManager.Current.page;switch(t._lastPageType){case 2:t._scrollBar=new n.Drawing.ScrollBar.FileScroll;break;case 0:t._scrollBar=new n.Drawing.ScrollBar.ProjectDcroll;break;case 1:case 3:default:t._scrollBar=new n.Drawing.ScrollBar.ScrollBar}}return t._scrollBar},enumerable:!0,configurable:!0}),t.prototype.up=function(){n.canScroll(!0)&&(this.y=this.y-this.scrollSpeed)},t.prototype.down=function(){n.canScroll(!1)&&(this.y=Math.max(0,this.scrollSpeed+this.y))},t}();n.ScrollService=t}(Inknote||(Inknote={})),function(n){var t=function(){function t(){this.drawing=new n.Drawing.Licence}return Object.defineProperty(t,"Instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),t}();n.LicenceService=t}(Inknote||(Inknote={})),function(n){function t(n){return n.sort(function(n,t){return n.order-t.order}),n}function i(t,i,r){var u=n.ScrollService.Instance;return t.isOver(i.clientX-u.x,i.clientY-50,r)}n.sortByOrder=t;n.mouseIsOver=i}(Inknote||(Inknote={})),function(n){var t=function(){function t(){}return Object.defineProperty(t,"Instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Menu",{get:function(){return this._menu||(this._menu=new n.Drawing.RightClickMenus.RightClickMenu),this._menu},enumerable:!0,configurable:!0}),t.prototype.openMenu=function(t,i,r){var u=new n.Drawing.RightClickMenus.RightClickMenu,f;n.Managers.PageManager.Current.page==2&&n.anyItemIs(n.Managers.ProjectManager.Instance.allProjects,function(t){return t.ID==n.Managers.ProjectManager.Instance.hoverID})&&(u=new n.Drawing.RightClickMenus.RightClickFile(n.Managers.ProjectManager.Instance.hoverID),n.Managers.ProjectManager.Instance.selectID=n.Managers.ProjectManager.Instance.hoverID);f=r.width>t+u.width;u.x=f?t:t-u.width;u.y=r.height>i+u.height?i:i-u.height;this._menu=u;this.visible=!0},t}();n.RightClickMenuService=t}(Inknote||(Inknote={})),function(n){var t=function(){function t(t){this._items=[];this._canvas=document.getElementById(t);this._ctx=this._canvas.getContext("2d");var i=this;this.draw=function(){var r,t;if(i._canvas.width=i._canvas.parentElement.clientWidth,i._canvas.height=i._canvas.parentElement.clientHeight-50,i.arrange(),i._items.push(n.LicenceService.Instance.drawing),n.Managers.MachineManager.Instance.machineType==0&&(i._items.push(n.ScrollService.ScrollBar),n.ScrollService.ScrollBar.scrollThumbnail.visible&&i._items.push(n.ScrollService.ScrollBar.scrollThumbnail)),n.RightClickMenuService.Instance.visible==!0&&i._items.push(n.RightClickMenuService.Instance.Menu),n.sortByOrder(i._items),n.Managers.PluginManager)for(r=n.getItemsWhere(n.Managers.PluginManager.Instance.plugins,function(n){return n.active&&n.allowBeforeDraw&&n.beforeDraw!=null}),t=0;t<r.length;t++)r[t].beforeDraw(i._ctx,i._canvas);for(t=0;t<i._items.length;t++)if(i._items[t].draw(i._ctx,i._canvas)===!1){n.log("Drawing failed on item "+i._items[t].ID);return}if(n.Managers.PluginManager)for(r=n.getItemsWhere(n.Managers.PluginManager.Instance.plugins,function(n){return n.active&&n.allowOnDraw&&n.onDraw!=null}),t=0;t<r.length;t++)r[t].onDraw(i._ctx,i._canvas);requestAnimationFrame(i.draw)};i.draw()}return t.prototype.setItems=function(n){this._items=n},Object.defineProperty(t.prototype,"canvas",{get:function(){return this._canvas},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){return this._items},enumerable:!0,configurable:!0}),t.prototype.arrange=function(){switch(n.Managers.PageManager.Current.page){case 0:this._items=n.ProjectConverter.toDrawing(this);break;case 2:this._items=n.FileConverter.toDrawing(this)}this.items.push(n.Drawing.Background.Instance)},t}();n.DrawService=t}(Inknote||(Inknote={})),function(n){var t=function(){function t(){this._refresh=!1;this._items=[];this.refresh()}return Object.defineProperty(t,"Instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),t.prototype.refresh=function(){this._refresh=!0},t.prototype.updateItems=function(){var s=n.Managers.ProjectManager.Instance.currentProject,i,r,u,f,t,e,o;this._projectID=s.ID;i=new n.Drawing.Flat;r=new n.Drawing.Natural;i.y=190;r.y=195;i.x=100;r.x=110;u=new n.Drawing.CrotchetRest;u.y=200;u.x=120;f=new n.Drawing.QuaverRest;f.y=200;f.x=130;t=new n.Drawing.Quaver(!1);t.x=150;t.y=200;t.attach(r);t.attach(i);e=new n.Drawing.HemiDemiSemiQuaver(!0);e.x=190;e.y=200;this._items.push(i);this._items.push(r);this._items.push(u);this._items.push(f);this._items.push(t);this._items.push(e);o=new n.Drawing.Crotchet(!0);o.x=500;o.y=500;this._items.push(o)},t.prototype.getItems=function(){return this._projectID!=n.Managers.ProjectManager.Instance.currentProject.ID&&this.refresh(),this._refresh&&this.updateItems(),this._refresh=!1,this._items},t}();n.ScoringService=t}(Inknote||(Inknote={})),function(n){var t;(function(t){function e(){for(var s,o,h,c,e=n.Managers.ProjectManager.Instance.currentProject,u=[],f=n.ScoringService.Instance.getItems(),t=0;t<f.length;t++){if(s=f[t].ID==n.ScoringService.Instance.hoverID,f[t].hover=s,f[t]instanceof n.Notation)for(o=0;o<f[t].attached.length;o++)f[t].attached[o].hover=s;u.push(f[t])}if(!e)return u.push(r),u;for(i.name=e.name,i.ID=e.ID,i.hover=i.ID==n.Managers.ProjectManager.Instance.hoverID,i.select=i.ID==n.Managers.ProjectManager.Instance.selectID,i.select&&n.Managers.MachineManager.Instance.machineType!=0&&u.push(n.Drawing.Keyboard.Instance),h=n.getItemsWhere(e.instruments,function(n){return n.visible}),c=180,t=0;t<h.length;t++)u.push(new n.Drawing.Stave(c,h[t].name)),c+=80;return u.push(i),e.pause&&u.push(r),u}function u(t){var i=new n.Compressed.CompressedProject(t.name),r;for(i.ID=t.ID,i.name=t.name,i.inknoteVersion=n.Managers.VersionManager.Instance.version,r=0;r<t.instruments.length;r++)i.instruments.push(o(t.instruments[r]));return i}function o(t){for(var r=new n.Compressed.Instrument(t.name),i=0;i<t.bars.length;i++)r.bars.push(s(t.bars[i]));return r}function s(){return new n.Compressed.Bar}function h(n){for(var r,i=[],t=0;t<n.length;t++)r=u(n[t]),i.push(r);return i}function f(t){var i,r;if(t.inknoteVersion!=n.Managers.VersionManager.Instance.version&&(n.log("project: "+t.name+" is of version "+t.inknoteVersion,2),n.log("this may cause errors when decompressing this saved files",2)),i=new n.Project(t.name),i.ID=t.ID,i.instruments=[],t.instruments)for(r=0;r<t.instruments.length;r++)i.instruments.push(c(t.instruments[r]));return i}function c(t){var r=new n.Model.Instrument(t.name),i;for(r.visible=!0,i=0;i<t.bars.length;i++)r.bars.push(l(t.bars[i]));return r}function l(){return new n.Model.Bar}function a(n){for(var r,i=[],t=0;t<n.length;t++)r=f(n[t]),i.push(r);return i}var r=new n.Drawing.LoadingSplash,i=new n.Drawing.Name("");t.toDrawing=e;t.compress=u;t.compressAll=h;t.decompress=f;t.decompressAll=a})(t=n.ProjectConverter||(n.ProjectConverter={}))}(Inknote||(Inknote={})),function(n){var t;(function(t){function r(t){for(var r,e=[],f=n.Managers.ProjectManager.Instance.allProjects,c=t.canvas,l=Math.floor(c.width/200),o=0,s=0,h=!1,u=0;u<f.length;u++)r=new n.Drawing.File(f[u].name),r.ID=f[u].ID,f[u].ID==n.Managers.ProjectManager.Instance.hoverID&&(r.hover=!0),f[u].ID==n.Managers.ProjectManager.Instance.selectID&&(r.select=!0,h=!0),r.x=o*200+100,r.y=s*200+100-n.ScrollService.Instance.y,e.push(r),o++,o>=l&&(o=0,s++);return h&&n.Managers.MachineManager.Instance.machineType!=0&&e.push(n.Drawing.BottomMenu.Instance),n.Managers.ProjectManager.Instance.currentProject.pause&&e.push(i),e}var i=new n.Drawing.LoadingSplash;t.toDrawing=r})(t=n.FileConverter||(n.FileConverter={}))}(Inknote||(Inknote={})),function(n){function t(t,i){var r=new n.Model.Note(t.value,t.octave,t.length);if(Math.round(i)!=i)throw new Error("Number of semitones must be an integer");return r.value=t.value+i%12,i>0&&(r.octave=t.octave+Math.floor(i/12)),i<0&&(r.octave=t.octave+Math.ceil(i/12)),r}function i(n){return t(n,4)}function r(n){return i(n)}function u(n){return t(n,3)}function f(n){return t(n,6)}function e(n){return t(n,7)}function o(n){return t(n,10)}function s(n){return t(n,11)}n.getNoteOfDistance=t;n.getThird=i;n.getMajorThird=r;n.getMinorThird=u;n.getFlatFifth=f;n.getFifth=e;n.getSeventh=o;n.getMajorSeventh=s}(Inknote||(Inknote={})),function(n){function t(t,i){var r=n.getNoteOfDistance(t,i);t.value=r.value;t.octave=r.octave}function i(n,i){for(var r=0;r<n.notes.length;r++)t(n.notes[r],i)}n.transposeNote=t;n.transposeChord=i}(Inknote||(Inknote={})),function(n){function t(n,t){var i=t;return i+t}function i(t){switch(t.length){case 0:return new n.Drawing.BreveRest;case 1:return new n.Drawing.SemiBreveRest;case 2:return new n.Drawing.MinimRest;case 3:return new n.Drawing.CrotchetRest;case 4:return new n.Drawing.QuaverRest;case 5:return new n.Drawing.SemiQuaverRest;case 6:return new n.Drawing.DemiSemiQuaverRest;case 7:return new n.Drawing.HemiDemiSemiQuaverRest}}n.requiredRestSpace=t;n.getDrawingItemFromRest=i}(Inknote||(Inknote={})),function(n){function t(n,t){return n.value==t.value&&n.octave==t.octave&&n.length==t.length}function i(n,t){return n.value==t.value&&n.octave==t.octave}function r(n,t){var i=t;return n.noteLength>3&&n.stemUp&&(i+=t),i+t}function u(t){var i=null,r=!0;switch(t.length){case 0:i=new n.Drawing.Breve(r);break;case 1:i=new n.Drawing.SemiBreve(r);break;case 2:i=new n.Drawing.Minim(r);break;case 3:i=new n.Drawing.Crotchet(r);break;case 4:i=new n.Drawing.Quaver(r);break;case 5:i=new n.Drawing.SemiQuaver(r);break;case 6:i=new n.Drawing.DemiSemiQuaver(r);break;case 7:i=new n.Drawing.HemiDemiSemiQuaver(r);break;default:i=new n.Drawing.Crotchet(r)}return i.ID=t.ID,i}n.notesAreEqual=t;n.notePitchesAreEqual=i;n.requiredNoteSpace=r;n.getDrawingItemFromNote=u}(Inknote||(Inknote={})),function(n){function t(t,i){for(var r=0;r<i.notes.length;r++)if(n.notePitchesAreEqual(t,i.notes[r]))return!0;return!1}function i(t){var i=[t,n.getMajorThird(t),n.getFifth(t)];return new n.Model.Chord(i)}function r(t){var i=[t,n.getMinorThird(t),n.getFifth(t)];return new n.Model.Chord(i)}n.noteIsInChord=t;n.getMajorTriad=i;n.getMinorTriad=r}(Inknote||(Inknote={})),function(n){function t(t,i,r,u){switch(n.Managers.SettingsManager.Instance.getCurrentSetting().notationType){case 0:return new n.ChordNotation.StandardChordNotation(t,i,r,u);case 1:return new n.ChordNotation.UPPER_lowerChordNotation(t,i,r,u);case 2:return new n.ChordNotation.DoReMiChordNotation(t,i,r,u);default:return new n.ChordNotation.StandardChordNotation(t,i,r,u)}}n.getCurrentChordNotation=t}(Inknote||(Inknote={})),function(n){function t(){throw new Error("Not fully implemented");}n.identifyChord=t}(Inknote||(Inknote={})),function(n){var t;(function(t){var i=new n.Compressed.CompressedProject("TestCompressed"),r,u;i.ID="42";r=new n.Compressed.Instrument("Violin");u=new n.Compressed.Instrument("Guitar");i.instruments=[r,u];t.$TEST$_compressedProject=i})(t=n.Testing||(n.Testing={}))}(Inknote||(Inknote={})),function(n){var t;(function(n){var t=function(){function n(){this.version="0.1"}return Object.defineProperty(n,"Instance",{get:function(){return n._instance||(n._instance=new n),this._instance},enumerable:!0,configurable:!0}),n}();n.VersionManager=t})(t=n.Managers||(n.Managers={}))}(Inknote||(Inknote={})),function(n){var t;(function(n){(function(n){n[n.Desktop=0]="Desktop";n[n.Tablet=1]="Tablet";n[n.Mobile=2]="Mobile"})(n.MachineType||(n.MachineType={}));var i=n.MachineType,t=function(){function n(){var n=!1;(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4)))&&(n=!0);this.machineType=n?2:0}return Object.defineProperty(n,"Instance",{get:function(){return n._instance||(n._instance=new n),n._instance},enumerable:!0,configurable:!0}),n}();n.MachineManager=t})(t=n.Managers||(n.Managers={}))}(Inknote||(Inknote={})),function(n){var t;(function(n){function i(n){switch(n){case 0:return"Score";case 1:return"Form";case 2:return"File";case 3:return"List";case 4:return"Licence"}}var t,r;(function(n){n[n.Score=0]="Score";n[n.Form=1]="Form";n[n.File=2]="File";n[n.List=3]="List";n[n.Licence=4]="Licence"})(n.Page||(n.Page={}));t=n.Page;r=function(){function r(){this.openPageFromURL()}return Object.defineProperty(r.prototype,"page",{get:function(){return this._page},set:function(t){var r="?"+i(t);switch(t){case 0:r+="="+n.ProjectManager.Instance.currentProject.ID;break;case 4:window.location.href="./licence";return}window.history.pushState(null,r,r);this._page=t},enumerable:!0,configurable:!0}),Object.defineProperty(r,"Current",{get:function(){return r._current||(r._current=new r),r._current},enumerable:!0,configurable:!0}),r.prototype.openNewPage=function(n,t){var r="?";console.log(r);r+=i(n);r+="=";r+=t;window.open(r)},r.prototype.openPageFromURL=function(){for(var i,u=window.location.search.replace("?",""),r=u.split("&"),n=0;n<r.length;n++)i=r[n].split("="),t[i[0]]&&(this.page=t[i[0]]);this._page==null&&(this.page=0)},r}();n.PageManager=r})(t=n.Managers||(n.Managers={}))}(Inknote||(Inknote={})),function(n){var t;(function(t){var i=function(){function t(){this._settings=[];t._instance&&n.log("Error: Instantiation failed. Use SettingsManager.Current() instead of new.");t._instance=this}return Object.defineProperty(t,"Current",{get:function(){return t.Instance.getCurrentSetting()},enumerable:!0,configurable:!0}),t.prototype.getCurrentSetting=function(){var i=t.Instance;return i._currentSetting||((!i._settings||i._settings.length<1)&&i.addSetting(new n.Setting("Default")),i.setCurrentSetting(i.getSettings()[0])),i._currentSetting},t.prototype.setCurrentSetting=function(n){this._currentSetting=n},t.prototype.getSettings=function(){return this._settings},t.prototype.setSettings=function(n){this._settings=n},t.prototype.addSettings=function(n){this._settings=this._settings.concat(n)},t.prototype.addSetting=function(n){this._settings=this._settings.concat(n)},Object.defineProperty(t,"Instance",{get:function(){return this._instance||(this._instance=new t),t._instance},enumerable:!0,configurable:!0}),t}();t.SettingsManager=i})(t=n.Managers||(n.Managers={}))}(Inknote||(Inknote={})),function(n){var t;(function(t){var i=function(){function i(){this._projects=[]}return i.prototype.addProjects=function(n){this._projects=this._projects.concat(n)},i.prototype.addProject=function(n){this._projects.push(n)},i.prototype.setCurrentProject=function(t){this._currentProject=n.getItemFromID(this._projects,t)},Object.defineProperty(i,"Instance",{get:function(){return i._instance||(i._instance=new i),i._instance},enumerable:!0,configurable:!0}),i.prototype.openProjectFromURL=function(){for(var t,r=window.location.search.replace("?",""),i=r.split("&"),n=0;n<i.length;n++)t=i[n].split("="),t[0]=="Score"&&this.setCurrentProject(t[1])},Object.defineProperty(i.prototype,"currentProject",{get:function(){return this._currentProject||(this._currentProject=new n.Project),this._currentProject},enumerable:!0,configurable:!0}),i.prototype.save=function(){this._projects.indexOf(this._currentProject)==-1&&this._projects.push(this._currentProject);var t=n.ProjectConverter.compressAll(this._projects);n.Storage.saveProjects(t)},Object.defineProperty(i.prototype,"allProjects",{get:function(){return this._projects},enumerable:!0,configurable:!0}),i.prototype.deleteSelectedProject=function(){this.deleteProjectByID(this.selectID)},i.prototype.deleteProjectByID=function(t){var r=n.getIndexFromID(this._projects,t),u=n.getItemFromID(this._projects,t),f=u.name,i=this;n.check('Are you sure you want to delete project "'+f+'"',function(){r!=null&&i._projects.splice(r,1);u.ID==i._currentProject.ID&&(i._currentProject=i._projects.length>0?n.last(i._projects):null);setTimeout(function(){i.currentProject.pause=!1},100)},function(){n.log('"'+f+'" deletion cancelled')})},i.prototype.openSelectedProject=function(){this.setCurrentProject(this.selectID);t.PageManager.Current.page=0;t.ProjectManager.Instance._currentProject.pause=!1;this.selectID=null},i.prototype.openProjectFromID=function(n){this.setCurrentProject(n);t.PageManager.Current.page=0;t.ProjectManager.Instance._currentProject.pause=!1;this.selectID=null},i.prototype.next=function(){var t=this._projects,i;if(t.length<2){this.selectID=t[0].ID;return}i=n.getIndexFromID(t,this.selectID);this.selectID=i==t.length-1||i==null?t[0].ID:t[i+1].ID},i.prototype.previous=function(){var t=this._projects,i,r;if(t.length<2){this.selectID=t[0].ID;return}i=n.getIndexFromID(t,this.selectID);i==0||i==null?(r=n.last(t),this.selectID=r.ID):this.selectID=t[i-1].ID},i}();t.ProjectManager=i})(t=n.Managers||(n.Managers={}))}(Inknote||(Inknote={})),function(n){var t;(function(t){var i=function(){function t(){this._plugins=[];this._pluginNames=[]}return Object.defineProperty(t,"Instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"plugins",{get:function(){return this._plugins},enumerable:!0,configurable:!0}),t.prototype.getCompressedPlugins=function(){for(var i,u,r=this.plugins,f=[],t=0;t<r.length;t++)i=new n.Plugins.Compressed.InknkotePlugin(r[t].name),i.ID=r[t].ID,i.active=r[t].active,i.allowOnDraw=r[t].allowOnDraw,i.allowOnSave=r[t].allowOnSave,u=this.findPluginNameByName(r[t].name),i.URL=u.URL,i.description=u.description,f.push(i);return f},t.prototype.addPlugin=function(n){this._plugins.push(n)},Object.defineProperty(t.prototype,"pluginNames",{get:function(){return this._pluginNames},enumerable:!0,configurable:!0}),t.prototype.addPluginName=function(n,t){this._pluginNames.push(n);t!==!0&&this.generatePluginHtml()},t.prototype.addPluginNames=function(n){for(var t in n)this.addPluginName(n[t],!0);this.generatePluginHtml()},t.prototype.removePlugin=function(n){for(var i=[],t=0;t<this._plugins.length;t++)this._plugins[t].ID!=n&&i.push(this._plugins[t]);this._plugins=i},t.prototype.setPluginNameVal=function(t,i){this._pluginNames[t].active=i;this.generatePluginHtml();setTimeout(function(){n.Storage.savePlugins()},200)},t.prototype.generateListHtml=function(){var e=this,o=document.getElementById("plugin-list-items"),f,r,i,u,t;o.innerHTML="";for(f in this._pluginNames)r=this._pluginNames[f],i=document.createElement("div"),i.className="plugin-list-item",u=document.createElement("div"),u.innerText=r.name+" - "+r.description,u.style.display="inline-block",t=document.createElement("input"),t.type="checkbox",t.checked=r.active,t.id="plugin-"+f,t.onclick=function(t){var i=t.target;i.checked?n.check("Are you sure you want this plugin?",function(){e.setPluginNameVal(i.id.split("-")[1],i.checked)},function(){i.checked=!i.checked}):e.setPluginNameVal(i.id.split("-")[1],i.checked)},i.appendChild(t),i.appendChild(u),o.appendChild(i)},t.prototype.getPluginsWithEvents=function(){for(var r,i=n.getItemsWhere(this._plugins,function(n){return n.active}),u=[],t=0;t<i.length;t++)r=i[t].getExistingFunctions(),r.length>0&&u.push({name:i[t].name,functions:r});return u},t.prototype.getPluginsByEvents=function(){for(var n,i,f,e,r,o,t=[],s=this.getPluginsWithEvents(),u=0;u<s.length;u++)for(n=s[u],i=0;i<n.functions.length;i++){for(f=n.functions[i],e=!1,r=0;r<t.length;r++)o=t[r],o.event==f&&(o.plugins.push(n.name),e=!0);e==!1&&t.push({event:f,plugins:[n.name]})}return t},t.prototype.setPluginOnSaveAllow=function(t,i){var r=t.split("...")[1],u=this.findPluginByName(r);u.allowOnSave=i;setTimeout(function(){n.Storage.savePlugins()},200)},t.prototype.setPluginOnDrawAllow=function(t,i){var r=t.split("...")[1],u=this.findPluginByName(r);u.allowOnDraw=i;setTimeout(function(){n.Storage.savePlugins()},200)},t.prototype.setPluginOnBeforeDrawAllow=function(t,i){var r=t.split("...")[1],u=this.findPluginByName(r);u.allowBeforeDraw=i;setTimeout(function(){n.Storage.savePlugins()},200)},t.prototype.generateEventListHtml=function(){var e=this,o=this.getPluginsByEvents(),s=document.getElementById("plugin-event-list"),r,l,u,t,n,i,f,a;for(s.innerHTML="<h3>Events<\/h3>",r=0;r<o.length;r++){var v=o[r].event,h=o[r].plugins,c=document.createElement("div");for(c.innerText=v,c.className="plugin-list-item",s.appendChild(c),l=document.createElement("div"),u=0;u<h.length;u++)if(t=this.findPluginByName(h[u]),t!=null){n=document.createElement("input");n.type="checkbox";switch(v){case"before draw":n.checked=t.allowBeforeDraw;i=t.name;n.id="ondraw..."+i;n.onclick=function(n){var t=n.target;e.setPluginOnBeforeDrawAllow(t.id,t.checked)};break;case"on draw":n.checked=t.allowOnDraw;i=t.name;n.id="ondraw..."+i;n.onclick=function(n){var t=n.target;e.setPluginOnDrawAllow(t.id,t.checked)};break;case"on save":n.checked=t.allowOnSave;i=t.name;n.id="onsave..."+i;n.onclick=function(n){var t=n.target;e.setPluginOnSaveAllow(t.id,t.checked)}}f=document.createElement("div");f.appendChild(n);a=document.createElement("span");a.innerText=h[u];f.appendChild(a);l.appendChild(f)}s.appendChild(l)}},t.prototype.generateAdvancedHtml=function(){},t.prototype.generatePluginHtml=function(){this.generateListHtml();this.generateEventListHtml();this.generateAdvancedHtml()},t.prototype.findPluginByName=function(t){var i=n.getItemsWhere(this._plugins,function(n){return n.name==t});return i.length==0?null:i[0]},t.prototype.findPluginNameByName=function(t){var i=n.getItemsWhere(this._pluginNames,function(n){return n.name==t});return i.length==0?null:i[0]},t}();t.PluginManager=i})(t=n.Managers||(n.Managers={}))}(Inknote||(Inknote={})),function(n){var t;(function(t){var i;(function(t){var i=function(){function t(t){this.name=t;this.ID=n.getID();this.allowOnSave=!0;this.allowOnDraw=!0}return t}();t.InknkotePlugin=i})(i=t.Compressed||(t.Compressed={}))})(t=n.Plugins||(n.Plugins={}))}(Inknote||(Inknote={})),function(n){var t;(function(t){var r=function(){function t(n,t,i){this.name=n;this.URL=t;this.description=i;this._active=!1;this.hasOpenedURL=!1}return Object.defineProperty(t.prototype,"active",{get:function(){return this._active},set:function(t){var r,i,u;this.hasOpenedURL?(r=n.Managers.PluginManager.Instance.findPluginByName(this.name),r.active=t,n.Managers.PluginManager.Instance.generatePluginHtml()):(i=document.createElement("script"),i.src=this.URL,i.onload=function(){return n.Managers.PluginManager.Instance.generatePluginHtml(),!1},u=document.getElementsByTagName("head")[0],u.appendChild(i),this.hasOpenedURL=!0);this._active=t},enumerable:!0,configurable:!0}),t}(),i;t.InknotePluginName=r;i=function(){function t(t){this.name=t;this.ID=n.getID();this._active=!0;this.allowOnSave=!0;this.allowBeforeDraw=!0;this.allowOnDraw=!0;var i=n.Managers.PluginManager.Instance.findPluginNameByName(t);i?(i.allowOnDraw!=null&&(this.allowOnDraw=i.allowOnDraw),i.allowOnSave!=null&&(this.allowOnSave=i.allowOnSave),i.allowBeforeDraw!=null&&(this.allowBeforeDraw=i.allowBeforeDraw),this.active=i.active):this.active=!1}return Object.defineProperty(t.prototype,"active",{get:function(){return this._active},set:function(n){this._active=n;n&&(this.allowOnDraw=!0,this.allowOnSave=!0,this.allowBeforeDraw=!0)},enumerable:!0,configurable:!0}),t.prototype.getExistingFunctions=function(){var n=[];return this.onSave&&n.push("on save"),this.onDraw&&n.push("on draw"),this.beforeDraw&&n.push("before draw"),n},t}();t.InknotePlugin=i})(t=n.Plugins||(n.Plugins={}))}(Inknote||(Inknote={})),function(n){var t;(function(t){function h(n){return new t.InknotePluginName(n.name,n.URL,n.description)}var s=[new t.InknotePluginName("snow background","./scripts/plugins/instances/snow-back.js","covers the background with snow"),new t.InknotePluginName("plugin2","./scripts/plugins/instances/plugin2.js","testing on draw"),new t.InknotePluginName("data storage","./scripts/plugins/instances/data-storage.js","testing on save")],r,i,f,o,u,e;for(n.Managers.PluginManager.Instance.addPluginNames(s),r=n.Storage.getPlugins(),i=0;i<r.length;i++)f=h(r[i]),o=n.Managers.PluginManager.Instance.findPluginNameByName(f.name),o||n.Managers.PluginManager.Instance.addPluginName(f),u=n.Managers.PluginManager.Instance.findPluginNameByName(r[i].name),e=r[i],u.active=r[i].active,u.allowOnDraw=e.allowOnDraw,u.allowOnSave=e.allowOnSave;setTimeout(function(){n.Managers.PluginManager.Instance.generatePluginHtml()},300)})(t=n.Plugins||(n.Plugins={}))}(Inknote||(Inknote={})),function(n){function t(t,e){n.ScrollService.Instance.x=0;n.ScrollService.Instance.y=0;n.Managers.ProjectManager.Instance.currentProject.pause=!0;n.Managers.ProjectManager.Instance.selectID="";switch(t){case 0:i();break;case 1:r();break;case 2:u();break;case 3:e||(e=0);f(e);break;default:n.log("Unknown action type",0)}setTimeout(function(){n.Managers.ProjectManager.Instance.currentProject.pause=!1},100)}function i(){var t=new n.Project("Untitled");n.Managers.ProjectManager.Instance.addProject(t);n.Managers.ProjectManager.Instance.setCurrentProject(t.ID);n.Managers.PageManager.Current.page=0;n.Managers.ProjectManager.Instance.currentProject.pause=!0}function r(){n.Managers.PageManager.Current.page=2}function u(){n.Managers.ProjectManager.Instance.save()}function f(t){n.Managers.PageManager.Current.page=t}(function(n){n[n.NewProject=0]="NewProject";n[n.OpenProject=1]="OpenProject";n[n.SaveProject=2]="SaveProject";n[n.ToPage=3]="ToPage"})(n.ActionType||(n.ActionType={}));var e=n.ActionType;n.Action=t}(Inknote||(Inknote={})),function(n){var t=function(){function t(n){this.drawService=n;var t=this;this.drawService.canvas.onmouseover=function(){t.drawService.canvas.onmousemove=function(n){t.hover(n)}};this.drawService.canvas.onmouseout=function(){t.drawService.canvas.onmousemove=null};this.drawService.canvas.onclick=function(n){t.click(n)};this.drawService.canvas.ondblclick=function(n){t.dblClick(n)};this.drawService.canvas.oncontextmenu=function(n){t.rightClick(n)}}return t.prototype.hover=function(t){for(var o,u,r=this.drawService.items,f=!1,e=[],i=0;i<r.length;i++)n.mouseIsOver(r[i],t,this.drawService.canvas)&&(n.Managers.PageManager.Current.page==0&&r[i]instanceof n.Notation&&e.push(r[i]),o=r[i].ID,n.Managers.ProjectManager.Instance.hoverID=o,f=!0,this.drawService.canvas.style.cursor="pointer");u=e.sort(function(n,t){return t.order-n.order});n.ScoringService.Instance.hoverID=u.length>0?u[0].ID:null;f||(n.Managers.ProjectManager.Instance.hoverID=null,this.drawService.canvas.style.cursor="")},t.prototype.click=function(t){for(var i,u=this.drawService.items,f=!1,r=0;r<u.length;r++)if(n.mouseIsOver(u[r],t,this.drawService.canvas)){if(i=u[r].ID,i==n.Drawing.Keyboard.Instance.ID){n.Drawing.Keyboard.Instance.click(t);return}if(i==n.Drawing.BottomMenu.Instance.ID){n.Drawing.BottomMenu.Instance.click(t);return}if(i==n.ScrollService.ScrollBar.ID){n.ScrollService.ScrollBar.click(t);return}if(i==n.ScrollService.ScrollBar.scrollThumbnail.ID){n.ScrollService.ScrollBar.scrollThumbnail.click(t);return}if(i==n.RightClickMenuService.Instance.Menu.ID){n.RightClickMenuService.Instance.Menu.click(t);n.RightClickMenuService.Instance.visible=!1;return}if(i==n.LicenceService.Instance.drawing.ID){n.LicenceService.Instance.drawing.click(t);return}n.Managers.ProjectManager.Instance.selectID=i;f=!0}f||(n.ScrollService.ScrollBar.scrollThumbnail.visible=!1,n.Managers.ProjectManager.Instance.selectID=null,n.RightClickMenuService.Instance.visible=!1)},t.prototype.dblClick=function(){n.Managers.PageManager.Current.page==2&&n.Managers.ProjectManager.Instance.selectID&&n.Managers.ProjectManager.Instance.openSelectedProject()},t.prototype.rightClick=function(t){n.RightClickMenuService.Instance.openMenu(t.clientX,t.clientY-50,this.drawService.canvas);t.preventDefault()},t}();n.CanvasControl=t}(Inknote||(Inknote={})),function(n){function t(t){if(t&&n.ScrollService.Instance.y-n.ScrollService.Instance.scrollSpeed<0)return n.ScrollService.Instance.y=0,!1;if(t)return!0;switch(n.Managers.PageManager.Current.page){case 2:var r=n.Managers.ProjectManager.Instance.allProjects.length,i={x:window.innerWidth,y:window.innerHeight-100},u=Math.floor(i.x/200),f=Math.ceil(r/u)*200+100;return f>n.ScrollService.Instance.y+n.ScrollService.Instance.scrollSpeed+i.y;case 0:return!1;default:return!1}}n.canScroll=t;window.onmousewheel=function(t){var i=!1;t.wheelDelta>0&&(i=!0);i?n.ScrollService.Instance.up():n.ScrollService.Instance.down()}}(Inknote||(Inknote={})),function(n){function t(t){var r=n.Managers.ProjectManager.Instance,i=r.currentProject;r.selectID==i.ID&&(t.keyCode==13?r.selectID=null:n.countWhere([16,17,18,20],function(n){return n==t.keyCode})>0||(i.name=t.keyCode==8?i.name.substr(0,i.name.length-1):t.keyCode==46?"":n.pascalCase(i.name+String.fromCharCode(t.keyCode))));t.preventDefault()}function i(t){var i=n.Managers.ProjectManager.Instance,r=i.currentProject;t.keyCode==13?i.openSelectedProject():t.keyCode==38?n.ScrollService.Instance.up():t.keyCode==40?n.ScrollService.Instance.down():t.keyCode==37?i.previous():t.keyCode==39?i.next():t.keyCode==46&&i.deleteSelectedProject()}document.onkeydown=function(t){n.CONFIRM_IS_OPEN||t.keyCode==8&&t.preventDefault()};window.onkeyup=function(r){if(!n.CONFIRM_IS_OPEN)switch(n.Managers.PageManager.Current.page){case 2:i(r);break;case 0:t(r)}}}(Inknote||(Inknote={})),function(n){function r(n){var r=n.className,u=r.indexOf("hidden")!=-1;u?i(n):t(n)}function t(n){var t=n.className,i=t.indexOf("hidden")!=-1;i||(n.className=n.className+" hidden")}function i(n){var t=n.className,i=t.indexOf("hidden")!=-1;i&&(n.className=n.className.replace("hidden",""))}function u(n){var t=n.className,i=t.indexOf("select")!=-1;i&&(n.className=n.className.replace("select",""))}function f(n){var t=n.className,i=t.indexOf("select")!=-1;i||(n.className=n.className+" select")}n.toggleElement=r;n.hideElement=t;n.showElement=i;n.deSelect=u;n.select=f}(FrontEnd||(FrontEnd={})),function(n){function i(n){var t=document.getElementById(n);FrontEnd.toggleElement(t);FrontEnd.toggleElement(document.getElementById("modal-cover"))}function r(){for(var t=document.getElementsByClassName("modal"),n=0;n<t.length;n++)t[n].className.indexOf("hidden")==-1&&FrontEnd.hideElement(t[n]);FrontEnd.hideElement(document.getElementById("modal-cover"))}function t(n){var t=document.getElementById(n);FrontEnd.hideElement(t);FrontEnd.hideElement(document.getElementById("modal-cover"))}function u(n){var t=document.getElementById(n);FrontEnd.showElement(t);FrontEnd.showElement(document.getElementById("modal-cover"))}function f(){var n=document.getElementById("report-text"),i=document.getElementById("report-checkbox");n.value="";i.checked=!1;t("report")}function e(){var n=document.getElementById("report-text"),i=document.getElementById("report-checkbox"),r=n.value,u=i.checked;n.value="";i.checked=!1;t("report")}n.toggle=i;n.hideAllModals=r;n.hide=t;n.show=u;n.cancelReport=f;n.submitReport=e}(Modal||(Modal={})),function(n){var t;(function(n){function t(n,t){for(var f,e,o=n,r=document.getElementsByClassName("plugin-menu-item"),u=["plugin-list","plugin-event-list","plugin-advanced"],i=0;i<r.length;i++)FrontEnd.deSelect(r[i]);for(i=0;i<u.length;i++)f=document.getElementById(u[i]),FrontEnd.hideElement(f);e=document.getElementById(t);FrontEnd.showElement(e);FrontEnd.select(o)}n.PluginMenuClick=t})(t=n.Plugins||(n.Plugins={}))}(Actions||(Actions={})),function(n){var t;(function(){var t=n.Managers.SettingsManager.Instance,u=new n.Setting("Default"),r,e;t.addSetting(u);t.addSettings(n.Storage.getSettings());var o=n.DrawingSettings.Instance,i=n.Managers.ProjectManager.Instance,f=n.ProjectConverter.decompressAll(n.Storage.getProjects());i.addProjects(f);i.openProjectFromURL();r=new n.DrawService("my-canvas");e=new n.CanvasControl(r)})(t=n.Main||(n.Main={}))}(Inknote||(Inknote={}));Inknote.Managers.SettingsManager.Current.testMode?(console.log("%cWARNING","color: white; border: 1px solid black; font-size: 40px; padding: 0 10px; background: red; text-shadow: 1px 1px 0 black;"),console.log("%cthis app is running in test mode","font-size: 15px; font-family: 'Courier New'")):(console.log("%cWARNING","color: white; border: 1px solid black; font-size: 40px; padding: 0 10px; background: red; text-shadow: 1px 1px 0 black;"),console.log("%cthis is the developer console","font-size: 15px; font-family: 'Courier New'"),console.log("%conly use this if you know what you are doing","font-size: 15px; font-family: 'Courier New'"));
//# sourceMappingURL=@script.min.js.map
